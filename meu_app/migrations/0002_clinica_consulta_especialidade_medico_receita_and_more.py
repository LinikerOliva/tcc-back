# Generated by Django 4.2.7 on 2025-12-01 01:52

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    dependencies = [
        ('meu_app', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Clinica',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('nome', models.CharField(max_length=150)),
                ('tipo', models.CharField(blank=True, max_length=100)),
                ('cnpj', models.CharField(blank=True, max_length=18)),
                ('telefone', models.CharField(blank=True, max_length=20)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('endereco', models.TextField(blank=True)),
                ('cidade', models.CharField(blank=True, max_length=100)),
                ('estado', models.CharField(blank=True, max_length=2)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Clínica',
                'verbose_name_plural': 'Clínicas',
            },
        ),
        migrations.CreateModel(
            name='Consulta',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('data_hora', models.DateTimeField()),
                ('duracao_minutos', models.PositiveIntegerField(default=30)),
                ('status', models.CharField(choices=[('agendada', 'Agendada'), ('confirmada', 'Confirmada'), ('cancelada', 'Cancelada'), ('concluida', 'Concluída')], default='agendada', max_length=20)),
                ('tipo', models.CharField(choices=[('primeira_consulta', 'Primeira Consulta'), ('retorno', 'Retorno'), ('urgencia', 'Urgência'), ('rotina', 'Rotina')], default='primeira_consulta', max_length=20)),
                ('motivo', models.TextField(help_text='Motivo da consulta')),
                ('observacoes', models.TextField(blank=True)),
                ('valor', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('data', models.DateTimeField(blank=True, null=True)),
                ('queixa_principal', models.TextField(blank=True, default='')),
                ('historia_doenca', models.TextField(blank=True, default='')),
                ('diagnostico', models.TextField(blank=True, default='')),
                ('conduta', models.TextField(blank=True, default='')),
                ('resumo_clinico', models.TextField(blank=True, default='')),
                ('assinatura_hash', models.CharField(blank=True, max_length=128)),
                ('assinatura_algoritmo', models.CharField(blank=True, max_length=50)),
                ('assinatura_carimbo_tempo', models.CharField(blank=True, max_length=256)),
                ('assinada_em', models.DateTimeField(blank=True, null=True)),
                ('documento_assinado', models.FileField(blank=True, null=True, upload_to='assinaturas/consultas/')),
            ],
            options={
                'verbose_name': 'Consulta',
                'verbose_name_plural': 'Consultas',
                'ordering': ['-data_hora'],
            },
        ),
        migrations.CreateModel(
            name='Especialidade',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', models.CharField(max_length=100, unique=True)),
                ('descricao', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Especialidade',
                'verbose_name_plural': 'Especialidades',
            },
        ),
        migrations.CreateModel(
            name='Medico',
            fields=[
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, primary_key=True, serialize=False, to=settings.AUTH_USER_MODEL)),
                ('crm', models.CharField(max_length=20, unique=True)),
                ('biografia', models.TextField(blank=True)),
                ('formacao', models.TextField(blank=True)),
                ('experiencia_anos', models.PositiveIntegerField(default=0)),
                ('valor_consulta', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('ativo', models.BooleanField(default=True)),
                ('status', models.CharField(choices=[('pendente', 'Pendente'), ('aprovado', 'Aprovado'), ('reprovado', 'Reprovado')], default='pendente', max_length=20)),
                ('template_config', models.JSONField(blank=True, default=dict, null=True)),
                ('logo', models.ImageField(blank=True, null=True, upload_to='logos/medicos/')),
                ('clinicas', models.ManyToManyField(blank=True, related_name='medicos', to='meu_app.clinica')),
                ('especialidades', models.ManyToManyField(related_name='medicos', to='meu_app.especialidade')),
            ],
            options={
                'verbose_name': 'Médico',
                'verbose_name_plural': 'Médicos',
            },
        ),
        migrations.CreateModel(
            name='Receita',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('medicamentos', models.TextField(help_text='Lista de medicamentos prescritos')),
                ('posologia', models.TextField(help_text='Instruções de uso')),
                ('observacoes', models.TextField(blank=True)),
                ('validade', models.DateField(blank=True, help_text='Data de validade da receita', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('data_emissao', models.DateTimeField(auto_now_add=True, null=True)),
                ('status', models.CharField(choices=[('PENDENTE', 'PENDENTE'), ('ASSINADA', 'ASSINADA')], default='PENDENTE', max_length=10)),
                ('hash_documento', models.CharField(blank=True, max_length=128)),
                ('algoritmo_assinatura', models.CharField(blank=True, max_length=50)),
                ('carimbo_tempo', models.CharField(blank=True, max_length=256)),
                ('assinada_em', models.DateTimeField(blank=True, null=True)),
                ('arquivo_assinado', models.FileField(blank=True, null=True, upload_to='assinaturas/receitas/')),
                ('arquivo_pdf_assinado', models.FileField(blank=True, null=True, upload_to='receitas_assinadas/')),
                ('assinada', models.BooleanField(default=False)),
            ],
            options={
                'verbose_name': 'Receita',
                'verbose_name_plural': 'Receitas',
            },
        ),
        migrations.CreateModel(
            name='TipoExame',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', models.CharField(max_length=100)),
                ('categoria', models.CharField(choices=[('laboratorial', 'Laboratorial'), ('imagem', 'Imagem'), ('cardiologico', 'Cardiológico'), ('neurologico', 'Neurológico'), ('outros', 'Outros')], max_length=20)),
                ('descricao', models.TextField(blank=True)),
                ('preparo', models.TextField(blank=True, help_text='Instruções de preparo para o exame')),
                ('valor_referencia', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('ativo', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Tipo de Exame',
                'verbose_name_plural': 'Tipos de Exames',
            },
        ),
        migrations.AddField(
            model_name='user',
            name='mfa_backup_codes',
            field=models.JSONField(blank=True, default=list),
        ),
        migrations.AddField(
            model_name='user',
            name='mfa_enabled',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='user',
            name='mfa_secret',
            field=models.CharField(blank=True, max_length=64),
        ),
        migrations.AlterField(
            model_name='user',
            name='cpf',
            field=models.CharField(max_length=14, unique=True, validators=[django.core.validators.RegexValidator(message='CPF deve estar no formato XXX.XXX.XXX-XX', regex='^\\d{3}\\.\\d{3}\\.\\d{3}-\\d{2}$')]),
        ),
        migrations.AlterField(
            model_name='user',
            name='role',
            field=models.CharField(choices=[('medico', 'Médico'), ('paciente', 'Paciente'), ('admin', 'Administrador'), ('clinica', 'Clínica'), ('secretaria', 'Secretária(o)')], max_length=20),
        ),
        migrations.CreateModel(
            name='SolicitacaoMedico',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('crm', models.CharField(max_length=20)),
                ('especialidade', models.CharField(blank=True, max_length=100)),
                ('instituicao_formacao', models.CharField(blank=True, max_length=150)),
                ('ano_formacao', models.CharField(blank=True, max_length=4)),
                ('residencia', models.CharField(blank=True, max_length=150)),
                ('instituicao_residencia', models.CharField(blank=True, max_length=150)),
                ('ano_residencia', models.CharField(blank=True, max_length=4)),
                ('experiencia', models.TextField(blank=True)),
                ('motivacao', models.TextField(blank=True)),
                ('diploma_medicina', models.FileField(blank=True, null=True, upload_to='solicitacoes/diplomas/')),
                ('certificado_residencia', models.FileField(blank=True, null=True, upload_to='solicitacoes/certificados/')),
                ('comprovante_experiencia', models.FileField(blank=True, null=True, upload_to='solicitacoes/experiencia/')),
                ('status', models.CharField(choices=[('pending', 'Pendente'), ('approved', 'Aprovada'), ('rejected', 'Rejeitada')], default='pending', max_length=20)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('rejected_at', models.DateTimeField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='solicitacoes_medico_aprovadas', to=settings.AUTH_USER_MODEL)),
                ('rejected_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='solicitacoes_medico_rejeitadas', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='solicitacoes_medico', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Secretaria',
            fields=[
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, primary_key=True, serialize=False, to=settings.AUTH_USER_MODEL)),
                ('ativo', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('clinicas', models.ManyToManyField(blank=True, related_name='secretarias', to='meu_app.clinica')),
                ('medicos', models.ManyToManyField(blank=True, related_name='secretarias', to='meu_app.medico')),
            ],
            options={
                'verbose_name': 'Secretária(o)',
                'verbose_name_plural': 'Secretárias(os)',
            },
        ),
        migrations.CreateModel(
            name='ReceitaItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('medicamento', models.CharField(max_length=255)),
                ('posologia', models.TextField(blank=True, default='')),
                ('quantidade', models.CharField(blank=True, max_length=50, null=True)),
                ('receita', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='itens', to='meu_app.receita')),
            ],
            options={
                'verbose_name': 'Item de Receita',
                'verbose_name_plural': 'Itens de Receita',
            },
        ),
        migrations.AddField(
            model_name='receita',
            name='assinada_por',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='receitas_assinadas', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='receita',
            name='consulta',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='receitas', to='meu_app.consulta'),
        ),
        migrations.CreateModel(
            name='Prontuario',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('queixa_principal', models.TextField()),
                ('historia_doenca_atual', models.TextField()),
                ('historia_patologica_pregressa', models.TextField(blank=True)),
                ('historia_familiar', models.TextField(blank=True)),
                ('historia_social', models.TextField(blank=True)),
                ('medicamentos_uso', models.TextField(blank=True)),
                ('alergias', models.TextField(blank=True)),
                ('pressao_arterial', models.CharField(blank=True, max_length=20)),
                ('frequencia_cardiaca', models.CharField(blank=True, max_length=10)),
                ('temperatura', models.CharField(blank=True, max_length=10)),
                ('saturacao_oxigenio', models.CharField(blank=True, max_length=10)),
                ('peso', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('altura', models.DecimalField(blank=True, decimal_places=2, max_digits=4, null=True)),
                ('exame_geral', models.TextField(blank=True)),
                ('sistema_cardiovascular', models.TextField(blank=True)),
                ('sistema_respiratorio', models.TextField(blank=True)),
                ('sistema_digestivo', models.TextField(blank=True)),
                ('sistema_neurologico', models.TextField(blank=True)),
                ('outros_sistemas', models.TextField(blank=True)),
                ('diagnostico_principal', models.TextField()),
                ('diagnosticos_secundarios', models.TextField(blank=True)),
                ('cid10', models.CharField(blank=True, help_text='Código CID-10', max_length=10)),
                ('conduta', models.TextField()),
                ('prescricao', models.TextField(blank=True)),
                ('exames_solicitados', models.TextField(blank=True)),
                ('orientacoes', models.TextField(blank=True)),
                ('data_retorno', models.DateField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('consulta', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='prontuario', to='meu_app.consulta')),
            ],
            options={
                'verbose_name': 'Prontuário',
                'verbose_name_plural': 'Prontuários',
            },
        ),
        migrations.CreateModel(
            name='Paciente',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('cpf', models.CharField(blank=True, max_length=14, null=True, unique=True, validators=[django.core.validators.RegexValidator(message='CPF deve estar no formato XXX.XXX.XXX-XX', regex='^\\d{3}\\.\\d{3}\\.\\d{3}-\\d{2}$')])),
                ('tipo_sanguineo', models.CharField(blank=True, choices=[('A+', 'A+'), ('A-', 'A-'), ('B+', 'B+'), ('B-', 'B-'), ('AB+', 'AB+'), ('AB-', 'AB-'), ('O+', 'O+'), ('O-', 'O-')], max_length=3)),
                ('peso', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('altura', models.DecimalField(blank=True, decimal_places=2, max_digits=4, null=True)),
                ('alergias', models.TextField(blank=True, help_text='Liste as alergias conhecidas')),
                ('condicoes_cronicas', models.TextField(blank=True, help_text='Condições crônicas conhecidas')),
                ('medicamentos_uso', models.TextField(blank=True, help_text='Medicamentos em uso contínuo')),
                ('contato_emergencia_nome', models.CharField(blank=True, max_length=100)),
                ('contato_emergencia_telefone', models.CharField(blank=True, max_length=15)),
                ('plano_saude', models.CharField(blank=True, max_length=100)),
                ('numero_carteirinha', models.CharField(blank=True, max_length=50)),
                ('user', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Paciente',
                'verbose_name_plural': 'Pacientes',
            },
        ),
        migrations.CreateModel(
            name='Notificacao',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('tipo', models.CharField(choices=[('consulta_agendada', 'Consulta Agendada'), ('consulta_cancelada', 'Consulta Cancelada'), ('exame_disponivel', 'Exame Disponível'), ('lembrete_consulta', 'Lembrete de Consulta'), ('sistema', 'Sistema')], max_length=20)),
                ('titulo', models.CharField(max_length=200)),
                ('mensagem', models.TextField()),
                ('lida', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notificacoes', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Notificação',
                'verbose_name_plural': 'Notificações',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Medicamento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', models.CharField(max_length=150)),
                ('apresentacao', models.CharField(blank=True, max_length=100)),
                ('concentracao', models.CharField(blank=True, max_length=100)),
                ('fabricante', models.CharField(blank=True, max_length=100)),
                ('ativo', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Medicamento',
                'verbose_name_plural': 'Medicamentos',
                'unique_together': {('nome', 'apresentacao', 'concentracao')},
            },
        ),
        migrations.CreateModel(
            name='HistoricoMedico',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('doencas_previas', models.TextField(blank=True)),
                ('cirurgias_previas', models.TextField(blank=True)),
                ('hospitalizacoes', models.TextField(blank=True)),
                ('vacinas', models.TextField(blank=True)),
                ('historia_familiar', models.TextField(blank=True)),
                ('habitos', models.TextField(blank=True, help_text='Tabagismo, etilismo, atividade física, etc.')),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('paciente', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='historico_medico', to='meu_app.paciente')),
            ],
            options={
                'verbose_name': 'Histórico Médico',
                'verbose_name_plural': 'Históricos Médicos',
            },
        ),
        migrations.CreateModel(
            name='Exame',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('solicitado', 'Solicitado'), ('agendado', 'Agendado'), ('realizado', 'Realizado'), ('cancelado', 'Cancelado')], default='solicitado', max_length=20)),
                ('data_solicitacao', models.DateTimeField(auto_now_add=True)),
                ('data_agendamento', models.DateTimeField(blank=True, null=True)),
                ('data_realizacao', models.DateTimeField(blank=True, null=True)),
                ('observacoes', models.TextField(blank=True)),
                ('resultado', models.TextField(blank=True)),
                ('arquivo_resultado', models.FileField(blank=True, null=True, upload_to='exames/')),
                ('valor', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('assinatura_hash', models.CharField(blank=True, max_length=128)),
                ('assinatura_algoritmo', models.CharField(blank=True, max_length=50)),
                ('assinatura_carimbo_tempo', models.CharField(blank=True, max_length=256)),
                ('assinado_em', models.DateTimeField(blank=True, null=True)),
                ('laudo_assinado', models.FileField(blank=True, null=True, upload_to='assinaturas/exames/')),
                ('assinado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='exames_assinados', to=settings.AUTH_USER_MODEL)),
                ('clinica_realizacao', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='exames', to='meu_app.clinica')),
                ('consulta', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='exames', to='meu_app.consulta')),
                ('medico_solicitante', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='exames_solicitados', to='meu_app.medico')),
                ('paciente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='exames', to='meu_app.paciente')),
                ('tipo_exame', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='meu_app.tipoexame')),
            ],
            options={
                'verbose_name': 'Exame',
                'verbose_name_plural': 'Exames',
                'ordering': ['-data_solicitacao'],
            },
        ),
        migrations.CreateModel(
            name='DigitalCertificate',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('label', models.CharField(blank=True, max_length=120)),
                ('tipo', models.CharField(choices=[('A1', 'A1'), ('A3', 'A3')], max_length=2)),
                ('provider', models.CharField(blank=True, help_text='ex.: local, token, cloud', max_length=50)),
                ('fingerprint', models.CharField(blank=True, max_length=128)),
                ('subject', models.CharField(blank=True, max_length=255)),
                ('issuer', models.CharField(blank=True, max_length=255)),
                ('valid_from', models.DateTimeField(blank=True, null=True)),
                ('valid_to', models.DateTimeField(blank=True, null=True)),
                ('arquivo', models.FileField(blank=True, help_text='Apenas para A1', null=True, upload_to='certificados/')),
                ('a3_reference', models.CharField(blank=True, help_text='Identificador do token/leitora para A3', max_length=120)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='certificados', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Certificado Digital',
                'verbose_name_plural': 'Certificados Digitais',
            },
        ),
        migrations.AddField(
            model_name='consulta',
            name='assinada_por',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='consultas_assinadas', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='consulta',
            name='clinica',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='consultas', to='meu_app.clinica'),
        ),
        migrations.AddField(
            model_name='consulta',
            name='medico',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='consultas', to='meu_app.medico'),
        ),
        migrations.AddField(
            model_name='consulta',
            name='paciente',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='consultas', to='meu_app.paciente'),
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('action', models.CharField(max_length=100)),
                ('entity', models.CharField(blank=True, max_length=100)),
                ('entity_id', models.CharField(blank=True, max_length=100)),
                ('status', models.CharField(choices=[('success', 'Sucesso'), ('fail', 'Falha')], default='success', max_length=20)),
                ('metadata', models.JSONField(blank=True, null=True)),
                ('ip_address', models.CharField(blank=True, max_length=45)),
                ('user_agent', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Auditoria',
                'verbose_name_plural': 'Auditorias',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='user',
            name='clinica',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='usuarios', to='meu_app.clinica'),
        ),
        migrations.CreateModel(
            name='PatientAccessChallenge',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('challenge_type', models.CharField(choices=[('pin', 'PIN'), ('otp', 'OTP'), ('qrcode', 'QR Code')], max_length=10)),
                ('code_hash', models.CharField(max_length=128)),
                ('expires_at', models.DateTimeField()),
                ('is_used', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('meta', models.JSONField(blank=True, default=dict, help_text='Metadados opcionais (ex.: salt, tentativa, ip)')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='challenges_criados', to=settings.AUTH_USER_MODEL)),
                ('paciente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='challenges', to='meu_app.paciente')),
            ],
            options={
                'verbose_name': 'Desafio de Acesso ao Prontuário',
                'verbose_name_plural': 'Desafios de Acesso ao Prontuário',
                'indexes': [models.Index(fields=['paciente', 'challenge_type', 'is_used'], name='meu_app_pat_pacient_ae4f0e_idx')],
            },
        ),
        migrations.CreateModel(
            name='MedicoPaciente',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('data_vinculo', models.DateTimeField(auto_now_add=True)),
                ('ativo', models.BooleanField(default=True)),
                ('observacoes', models.TextField(blank=True)),
                ('medico', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pacientes_vinculados', to='meu_app.medico')),
                ('paciente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='medicos_vinculados', to='meu_app.paciente')),
            ],
            options={
                'verbose_name': 'Vínculo Médico-Paciente',
                'verbose_name_plural': 'Vínculos Médico-Paciente',
                'unique_together': {('medico', 'paciente')},
            },
        ),
        migrations.CreateModel(
            name='Agendamento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('data_hora_inicio', models.DateTimeField()),
                ('data_hora_fim', models.DateTimeField()),
                ('disponivel', models.BooleanField(default=True)),
                ('observacoes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('medico', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='agendamentos', to='meu_app.medico')),
            ],
            options={
                'verbose_name': 'Agendamento',
                'verbose_name_plural': 'Agendamentos',
                'unique_together': {('medico', 'data_hora_inicio')},
            },
        ),
    ]
